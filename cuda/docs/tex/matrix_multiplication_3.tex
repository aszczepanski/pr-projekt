
\subsection{Wersja 3}

\subsubsection{Opis rozwiązania}

W trzecim podejściu wykorzystana została pamięć współdzielona. W kolejnych iteracjach pętli po blokach najpierw wczytywany jest blok do pamięci współdzielonej (każdy wątek wczytuje jedną komórkę), a następnie wykonywane są obliczenia na dostępnych danych. W tym podejściu niezbędne jest synchronizowanie się wątków dwukrotnie w każdej iteracji.

\lstinputlisting[caption=Mnożenie macierzy kwadratowych na GPU -- wersja 3.]{./code/matrix_multiplication_3.cpp}

\subsubsection{Teoretyczna zajętość SM}

\subsubsection{Wyniki pomiarów}

\paragraph{Czas trwania obliczeń}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{3}{c|}{Rozmiar bloku} \\ \cline{2-4}
& 8x8 & 16x16 & 22x22 \\ \hline
176x176 & 0.316 & 0.181 & 0.374 \\ \hline
352x352 & 2.351 & 1.297 & 2.343 \\ \hline
528x528 & 7.666 & 4.075 & 7.389 \\ \hline
\end{tabular}
\caption{Czas obliczeń [ms] -- wersja 3.}
\end{table}

\paragraph{Ilość operacji zmiennoprzecinkowych na sekundę}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{3}{c|}{Rozmiar bloku} \\ \cline{2-4}
& 8x8 & 16x16 & 22x22 \\ \hline
176x176 & 34.491 & 60.169 & 29.138 \\ \hline
352x352 & 37.106 & 67.273 & 37.231 \\ \hline
528x528 & 38.402 & 72.246 & 39.844 \\ \hline
\end{tabular}
\caption{Ilosc operacji zmiennoprzecinkowych na sekundę (GFLOPS) -- wersja 1.}
\end{table}

\paragraph{Ilość instrukcji wykonanych na sekundę}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{3}{c|}{Rozmiar bloku} \\ \cline{2-4}
& 8x8 & 16x16 & 22x22 \\ \hline
176x176 & 0.16910 & 0.23896 & 0.12664 \\ \hline
352x352 & 0.17807 & 0.28408 & 0.15949 \\ \hline
528x528 & 0.18043 & 0.30390 & 0.17317 \\ \hline
\end{tabular}
\caption{Ilość instrukcji wykonana na sekundę (GIPS) -- wersja 1.}
\end{table}

\paragraph{CGMA}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{3}{c|}{Rozmiar bloku} \\ \cline{2-4}
& 8x8 & 16x16 & 22x22 \\ \hline
176x176 & 129.067 & 516.267 & 354.253 \\ \hline
352x352 & 128.000 & 507.803 & 382.302 \\ \hline
528x528 & 127.765 & 510.593 & 380.668 \\ \hline
\end{tabular}
\caption{Stosunek ilości operacji zmiennoprzecinkowych do ilości operacji odczytu/zapisu z pamięci globalnej -- wersja 1.}
\end{table}


% TODO: merge tables

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{2}{c|}{Rozmiar bloku} \\ \cline{2-3}
& 8x8 & 16x16 \\ \hline
128x128 & 0.140 & 0.093 \\ \hline
256x256 & 0.930 & 0.519 \\ \hline
384x384 & 3.034 & 1.642 \\ \hline
512x512 & 7.001 & 3.764 \\ \hline
640x640 & 13.820 & 7.301 \\ \hline
\end{tabular}
\caption{Czas obliczeń [ms] -- wersja 3.}
\end{table}

\subsubsection{Ilosc operacji zmiennoprzecinkowych na sekundę}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{2}{c|}{Rozmiar bloku} \\ \cline{2-3}
& 8x8 & 16x16 \\ \hline
128x128 & 29.857 & 45.291 \\ \hline
256x256 & 36.086 & 64.603 \\ \hline
384x384 & 37.322 & 68.970 \\ \hline
512x512 & 38.341 & 71.314 \\ \hline
640x640 & 37.938 & 71.812 \\ \hline
\end{tabular}
\caption{Ilosc operacji zmiennoprzecinkowych na sekundę (GFLOPS) -- wersja 1.}
\end{table}

\subsubsection{Ilość instrukcji wykonana na sekundę}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{2}{c|}{Rozmiar bloku} \\ \cline{2-3}
& 8x8 & 16x16 \\ \hline
128x128 & 0.1639 & 0.1562 \\ \hline
256x256 & 0.1754 & 0.2622 \\ \hline
384x384 & 0.1767 & 0.2926 \\ \hline
512x512 & 0.1802 & 0.2948 \\ \hline
640x640 & 0.1775 & 0.2989 \\ \hline
\end{tabular}
\caption{Ilość instrukcji wykonana na sekundę (GIPS) -- wersja 1.}
\end{table}

\subsubsection{CGMA}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
\multirow{2}{*}{Rozmiar macierzy} & \multicolumn{2}{c|}{Rozmiar bloku} \\ \cline{2-3}
& 8x8 & 16x16 \\ \hline
128x128 & 120.471 & 546.133 \\ \hline
256x256 & 128.502 & 520.127 \\ \hline
384x384 & 128.000 & 515.580 \\ \hline
512x512 & 127.626 & 514.008 \\ \hline
640x640 & 127.760 & 510.723 \\ \hline
\end{tabular}
\caption{Stosunek ilości operacji zmiennoprzecinkowych do ilości operacji odczytu/zapisu z pamięci globalnej -- wersja 1.}
\end{table}

